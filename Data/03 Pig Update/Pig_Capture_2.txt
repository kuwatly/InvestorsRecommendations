grunt> trades_2 = FOREACH trades GENERATE investor_id AS investor_id_2, trade_id AS trade_id_2, rating AS rating_2 ;
grunt> joinedtradeds = JOIN trades BY investor_id, trades_2 BY investor_id_2 ;
grunt> groupedtrades = group  joinedtradeds  by (trade_id,trade_id_2);
grunt> cooccurrence = FOREACH groupedtrades GENERATE
>> group.trade_id as trade_id,
>> group.trade_id_2 as trade_id_2,
>> COUNT($1) as tradecount;
grunt>
grunt> describe trades_2;
trades_2: {investor_id_2: int,trade_id_2: int,rating_2: int}
grunt> dump trades_2;
(1,101,1)
(2,101,2)
(3,101,3)
(4,101,4)
(5,101,5)
(6,101,5)
(2,102,1)
(3,102,2)
(5,102,3)
(1,103,1)
(2,103,2)
(3,103,3)
(5,103,4)
(1,104,1)
(3,104,2)
(5,104,4)
(6,104,5)
(4,105,1)
(5,105,2)
(6,105,5)
(1,106,1)
(5,106,2)
(6,107,1)

grunt> describe joinedtradeds;
joinedtradeds: {trades::investor_id: int,trades::trade_id: int,trades::rating: int,trades_2::investor_id_2: int,trades_2::trade_id_2: int,trades_2::rating_2: int}
grunt> dump trades_2;
(1,104,1,1,104,1)
(1,104,1,1,106,1)
(1,104,1,1,103,1)
(1,104,1,1,101,1)
(1,106,1,1,104,1)
(1,106,1,1,106,1)
(1,106,1,1,103,1)
(1,106,1,1,101,1)
(1,103,1,1,104,1)
(1,103,1,1,106,1)
(1,103,1,1,103,1)
(1,103,1,1,101,1)
(1,101,1,1,104,1)
(1,101,1,1,106,1)
(1,101,1,1,103,1)
(1,101,1,1,101,1)
(2,101,2,2,101,2)
(2,101,2,2,102,1)
(2,101,2,2,103,2)
(2,102,1,2,101,2)
(2,102,1,2,102,1)
(2,102,1,2,103,2)
(2,103,2,2,101,2)
(2,103,2,2,102,1)
(2,103,2,2,103,2)
(3,103,3,3,103,3)
(3,103,3,3,104,2)
(3,103,3,3,102,2)
(3,103,3,3,101,3)
(3,104,2,3,103,3)
(3,104,2,3,104,2)
(3,104,2,3,102,2)
(3,104,2,3,101,3)
(3,102,2,3,103,3)
(3,102,2,3,104,2)
(3,102,2,3,102,2)
(3,102,2,3,101,3)
(3,101,3,3,103,3)
(3,101,3,3,104,2)
(3,101,3,3,102,2)
(3,101,3,3,101,3)
(4,105,1,4,105,1)
(4,105,1,4,101,4)
(4,101,4,4,105,1)
(4,101,4,4,101,4)
(5,105,2,5,105,2)
(5,105,2,5,102,3)
(5,105,2,5,106,2)
(5,105,2,5,101,5)
(5,105,2,5,104,4)
(5,105,2,5,103,4)
(5,102,3,5,105,2)
(5,102,3,5,102,3)
(5,102,3,5,106,2)
(5,102,3,5,101,5)
(5,102,3,5,104,4)
(5,102,3,5,103,4)
(5,106,2,5,105,2)
(5,106,2,5,102,3)
(5,106,2,5,106,2)
(5,106,2,5,101,5)
(5,106,2,5,104,4)
(5,106,2,5,103,4)
(5,101,5,5,105,2)
(5,101,5,5,102,3)
(5,101,5,5,106,2)
(5,101,5,5,101,5)
(5,101,5,5,104,4)
(5,101,5,5,103,4)
(5,104,4,5,105,2)
(5,104,4,5,102,3)
(5,104,4,5,106,2)
(5,104,4,5,101,5)
(5,104,4,5,104,4)
(5,104,4,5,103,4)
(5,103,4,5,105,2)
(5,103,4,5,102,3)
(5,103,4,5,106,2)
(5,103,4,5,101,5)
(5,103,4,5,104,4)
(5,103,4,5,103,4)
(6,104,5,6,104,5)
(6,104,5,6,105,5)
(6,104,5,6,101,5)
(6,104,5,6,107,1)
(6,105,5,6,104,5)
(6,105,5,6,105,5)
(6,105,5,6,101,5)
(6,105,5,6,107,1)
(6,101,5,6,104,5)
(6,101,5,6,105,5)
(6,101,5,6,101,5)
(6,101,5,6,107,1)
(6,107,1,6,104,5)
(6,107,1,6,105,5)
(6,107,1,6,101,5)
(6,107,1,6,107,1)


grunt> describe groupedtrades;
groupedtrades: {group: (trades::trade_id: int,trades_2::trade_id_2: int),joinedtradeds: {(trades::investor_id: int,trades::trade_id: int,trades::rating: int,trades_2::investor_id_2: int,trades_2::trade_id_2: int,trades_2::rating_2: int)}}
grunt> dump groupedtrades;
((101,101),{(2,101,2,2,101,2),(5,101,5,5,101,5),(4,101,4,4,101,4),(1,101,1,1,101,1),(3,101,3,3,101,3),(6,101,5,6,101,5)})
((101,102),{(3,101,3,3,102,2),(2,101,2,2,102,1),(5,101,5,5,102,3)})
((101,103),{(1,101,1,1,103,1),(5,101,5,5,103,4),(3,101,3,3,103,3),(2,101,2,2,103,2)})
((101,104),{(1,101,1,1,104,1),(6,101,5,6,104,5),(3,101,3,3,104,2),(5,101,5,5,104,4)})
((101,105),{(6,101,5,6,105,5),(5,101,5,5,105,2),(4,101,4,4,105,1)})
((101,106),{(5,101,5,5,106,2),(1,101,1,1,106,1)})
((101,107),{(6,101,5,6,107,1)})
((102,101),{(3,102,2,3,101,3),(5,102,3,5,101,5),(2,102,1,2,101,2)})
((102,102),{(3,102,2,3,102,2),(5,102,3,5,102,3),(2,102,1,2,102,1)})
((102,103),{(2,102,1,2,103,2),(3,102,2,3,103,3),(5,102,3,5,103,4)})
((102,104),{(5,102,3,5,104,4),(3,102,2,3,104,2)})
((102,105),{(5,102,3,5,105,2)})
((102,106),{(5,102,3,5,106,2)})
((103,101),{(1,103,1,1,101,1),(5,103,4,5,101,5),(3,103,3,3,101,3),(2,103,2,2,101,2)})
((103,102),{(5,103,4,5,102,3),(3,103,3,3,102,2),(2,103,2,2,102,1)})
((103,103),{(3,103,3,3,103,3),(2,103,2,2,103,2),(1,103,1,1,103,1),(5,103,4,5,103,4)})
((103,104),{(5,103,4,5,104,4),(3,103,3,3,104,2),(1,103,1,1,104,1)})
((103,105),{(5,103,4,5,105,2)})
((103,106),{(1,103,1,1,106,1),(5,103,4,5,106,2)})
((104,101),{(3,104,2,3,101,3),(1,104,1,1,101,1),(5,104,4,5,101,5),(6,104,5,6,101,5)})
((104,102),{(3,104,2,3,102,2),(5,104,4,5,102,3)})
((104,103),{(1,104,1,1,103,1),(5,104,4,5,103,4),(3,104,2,3,103,3)})
((104,104),{(6,104,5,6,104,5),(5,104,4,5,104,4),(1,104,1,1,104,1),(3,104,2,3,104,2)})
((104,105),{(5,104,4,5,105,2),(6,104,5,6,105,5)})
((104,106),{(5,104,4,5,106,2),(1,104,1,1,106,1)})
((104,107),{(6,104,5,6,107,1)})
((105,101),{(5,105,2,5,101,5),(6,105,5,6,101,5),(4,105,1,4,101,4)})
((105,102),{(5,105,2,5,102,3)})
((105,103),{(5,105,2,5,103,4)})
((105,104),{(6,105,5,6,104,5),(5,105,2,5,104,4)})
((105,105),{(5,105,2,5,105,2),(6,105,5,6,105,5),(4,105,1,4,105,1)})
((105,106),{(5,105,2,5,106,2)})
((105,107),{(6,105,5,6,107,1)})
((106,101),{(1,106,1,1,101,1),(5,106,2,5,101,5)})
((106,102),{(5,106,2,5,102,3)})
((106,103),{(5,106,2,5,103,4),(1,106,1,1,103,1)})
((106,104),{(1,106,1,1,104,1),(5,106,2,5,104,4)})
((106,105),{(5,106,2,5,105,2)})
((106,106),{(5,106,2,5,106,2),(1,106,1,1,106,1)})
((107,101),{(6,107,1,6,101,5)})
((107,104),{(6,107,1,6,104,5)})
((107,105),{(6,107,1,6,105,5)})
((107,107),{(6,107,1,6,107,1)})

grunt> describe cooccurrence;
cooccurrence: {trade_id: int,trade_id_2: int,tradecount: long}
grunt> dump cooccurrence;
(101,101,6)
(101,102,3)
(101,103,4)
(101,104,4)
(101,105,3)
(101,106,2)
(101,107,1)
(102,101,3)
(102,102,3)
(102,103,3)
(102,104,2)
(102,105,1)
(102,106,1)
(103,101,4)
(103,102,3)
(103,103,4)
(103,104,3)
(103,105,1)
(103,106,2)
(104,101,4)
(104,102,2)
(104,103,3)
(104,104,4)
(104,105,2)
(104,106,2)
(104,107,1)
(105,101,3)
(105,102,1)
(105,103,1)
(105,104,2)
(105,105,3)
(105,106,1)
(105,107,1)
(106,101,2)
(106,102,1)
(106,103,2)
(106,104,2)
(106,105,1)
(106,106,2)
(107,101,1)
(107,104,1)
(107,105,1)
(107,107,1)

